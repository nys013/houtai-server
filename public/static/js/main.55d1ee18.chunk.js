(this["webpackJsonpreact-houtai"]=this["webpackJsonpreact-houtai"]||[]).push([[0],{1214:function(e,t,a){},1215:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),s=a(58),o=a(17),i=a(18),l=a(21),u=a(19),p=a(22),m=a(105),d=a(119),h=(a(68),a(28)),f=(a(122),a(35)),g=(a(97),a(43)),b=(a(123),a(6)),y=a(16),v=a.n(y),E=a(31),O=(a(551),a(240)),k=a.n(O),j=(a(98),a(32)),w=a(241),C=a(337),x=a.n(C);function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(n,r){("GET"===a?x.a.get(e,{params:t}):x.a.post(e,t)).then((function(e){n(e.data)})).catch((function(e){j.a.error("\u8bf7\u6c42\u53d1\u751f\u9519\u8bef"+e)}))}))}var N=a(517),I=a.n(N),_=function(e,t){return S("/api/login",{username:e,password:t},"POST")},T=function(e){return new Promise((function(t,a){var n="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=3p49MVra6urFRGOT9s8UBWr2");I()(n,{},(function(e,a){if(!e){var n=a.results[0].weather_data[0],r=n.dayPictureUrl,c=n.weather;"success"===a.status?t({dayPictureUrl:r,weather:c}):j.a.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25")}}))}))},P=function(e){return S("/api/manage/category/list",{parentId:e})},F=function(e,t){return S("/api/manage/category/add",{categoryName:e,parentId:t},"POST")},A=function(e,t){return S("/api/manage/product/list",{pageNum:e,pageSize:t})},R=function(e){var t=e.pageNum,a=e.pageSize,n=e.searchKey,r=e.searchType;return S("/api/manage/product/search",Object(w.a)({pageNum:t,pageSize:a},r,n))},D=function(e){return S("/api/manage/category/info",{categoryId:e})},U=function(e,t){return S("/api/manage/product/updateStatus",{productId:e,status:t},"POST")},K=function(e){return S("/api/manage/img/delete",{name:e},"POST")},M=function(e){return S("/api/manage/product/"+(e._id?"update":"add"),e,"POST")},L=function(e){return S("/api/manage/role/add",{roleName:e},"POST")},V=function(e){return S("/api/manage/role/update",e,"POST")},q=a(253),z=a.n(q),H=function(e){z.a.set("user_key",e)},B=function(){return z.a.get("user_key")||{}},J=function(){z.a.remove("user_key")},W=function(e){return{type:"set_header_title",data:e}},Q=function(){return J(),{type:"reset_user"}},G=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(){var e=Object(E.a)(v.a.mark((function e(t,n){var r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?console.log("\u63d0\u4ea4\u5931\u8d25"):(r=n.username,c=n.password,a.props.login(r,c));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.validatorPwd=function(e,t,a){t?t.length<4?a("\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e4\u4f4d"):t.length>12?a("\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc712\u4f4d"):/^[A-z0-9_]+$/.test(t)?a():a("\u5bc6\u7801\u5fc5\u987b\u4ee5\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"):a("\u5bc6\u7801\u5fc5\u987b\u8f93\u5165")},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.user;return e._id?r.a.createElement(d.a,{to:"/home"}):r.a.createElement("div",{className:"login-wrap"},r.a.createElement("div",{className:"login-header"},r.a.createElement("img",{src:k.a,alt:"logo"}),r.a.createElement("h1",null,"React\u9879\u76ee\uff1a\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf")),r.a.createElement("div",{className:"login-content"},r.a.createElement("div",{className:e.msg?"error-msg show":"error-msg"},e.msg),r.a.createElement("h2",null,"\u7528\u6237\u767b\u5f55"),r.a.createElement(f.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(f.a.Item,null,this.props.form.getFieldDecorator("username",{rules:[{required:!0,message:"\u7528\u6237\u540d\u5fc5\u987b\u8f93\u5165"},{max:12,message:"\u7528\u6237\u540d\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc712\u4f4d"},{min:3,message:"\u7528\u6237\u540d\u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e3\u4f4d"},{pattern:/^[A-z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u4ee5\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"}],initialValue:"admin"})(r.a.createElement(g.a,{prefix:r.a.createElement(b.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d"}))),r.a.createElement(f.a.Item,null,this.props.form.getFieldDecorator("password",{rules:[{validator:this.validatorPwd}]})(r.a.createElement(g.a,{prefix:r.a.createElement(b.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u5bc6\u7801"}))),r.a.createElement(f.a.Item,null,r.a.createElement(h.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"\u767b\u5f55")))))}}]),t}(n.Component),$=f.a.create()(G),X=Object(s.b)((function(e){return{user:e.user}}),{login:function(e,t){return function(){var a=Object(E.a)(v.a.mark((function a(n){var r;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_(e,t);case 2:0===(r=a.sent).status?(H(r.data),n({type:"receive_user",user:r.data}),j.a.success("\u767b\u5f55\u6210\u529f")):n({type:"send_error_msg",msg:r.msg});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}})($),Y=(a(698),a(172)),Z=(a(178),a(71));a(701);function ee(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}a(702);function te(e){return r.a.createElement("button",Object.assign({},e,{className:"link-button"}))}var ae=Z.a.confirm,ne=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={currentTime:"",weather:"",dayPictureUrl:""},a.getCurrentTime=function(){a.intervalId=setInterval((function(){var e=ee(Date.now());a.setState({currentTime:e})}),1e3)},a.getWeather=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t);case 2:n=e.sent,r=n.dayPictureUrl,c=n.weather,a.setState({dayPictureUrl:r,weather:c});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.logout=function(){ae({title:"\u4f60\u786e\u5b9a\u8981\u9000\u51fa\u5417\uff1f",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){a.props.logout()}})},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getCurrentTime(),this.getWeather("\u4e0a\u6d77")}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.state,t=e.currentTime,a=e.weather,n=e.dayPictureUrl;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-top"},r.a.createElement("span",null,"\u6b22\u8fce\uff1a",this.props.user.username),r.a.createElement(te,{onClick:this.logout},"\u9000\u51fa")),r.a.createElement("div",{className:"header-bottom"},r.a.createElement("div",{className:"header-bottom-left"},r.a.createElement("h1",null,this.props.headerTitle)),r.a.createElement("div",{className:"header-bottom-right"},r.a.createElement("span",null,t),r.a.createElement("img",{src:n,alt:""}),r.a.createElement("span",null,a))))}}]),t}(n.Component),re=Object(s.b)((function(e){return{headerTitle:e.headerTitle,user:e.user}}),{logout:Q})(Object(d.g)(ne)),ce=(a(705),a(145)),se=(a(708),[{title:"\u9996\u9875",key:"/home",icon:"home",isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]},{title:"\u8ba2\u5355\u7ba1\u7406",key:"/order",icon:"windows"}]),oe=ce.a.SubMenu,ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).setAuth=function(e){var t=e.isPublic,n=e.key,r=e.children,c=a.props.user,s=c.role,o=c.username;return!(!t&&"admin"!==o&&-1===s.menus.indexOf(n))||!!r&&!!r.find((function(e){return-1!==s.menus.indexOf(e.key)}))},a.getMenuNodes_reduce=function(e){return e.reduce((function(e,t){var n=a.props.location.pathname;a.setAuth(t)&&(t.children?(t.children.find((function(e){return 0===n.indexOf(e.key)}))&&(a.openKey=t.key),e.push(r.a.createElement(oe,{key:t.key,title:r.a.createElement("span",null,r.a.createElement(b.a,{type:t.icon}),r.a.createElement("span",null,t.title))},a.getMenuNodes_reduce(t.children)))):(0===n.indexOf(t.key)&&a.props.setHeaderTitle(t.title),e.push(r.a.createElement(ce.a.Item,{key:t.key},r.a.createElement(m.b,{to:t.key,onClick:function(){return a.props.setHeaderTitle(t.title)}},r.a.createElement(b.a,{type:t.icon}),r.a.createElement("span",null,t.title))))));return e}),[])},a.MenuNodes=a.getMenuNodes_reduce(se),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.location.pathname;e=0===e.indexOf("/product")?"/product":e;var t=this.openKey;return r.a.createElement("div",{className:"left-nav"},r.a.createElement(m.b,{to:"/",className:"left-nav-header"},r.a.createElement("img",{src:k.a,alt:"logo"}),r.a.createElement("h1",null,"\u7845\u8c37\u540e\u53f0")),r.a.createElement(ce.a,{mode:"inline",theme:"dark",selectedKeys:[e],defaultOpenKeys:[t]},this.MenuNodes))}}]),t}(n.Component),le=Object(s.b)((function(e){return{user:e.user}}),{setHeaderTitle:W})(Object(d.g)(ie)),ue=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",{style:{fontSize:80,fontWeight:"bold",textAlign:"center"}},"\u6b22\u8fce\u8fdb\u5165\u7845\u8c37\u540e\u53f0"))}}]),t}(n.Component),pe=(a(104),a(47)),me=(a(238),a(118)),de=(a(215),a(66)),he=a(1),fe=a.n(he),ge=f.a.Item,be=de.a.Option,ye=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).props.setForm(a.props.form),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.parentId,n=t.categorys;return r.a.createElement(f.a,null,r.a.createElement(ge,null,e("parentId",{initialValue:a})(r.a.createElement(de.a,null,r.a.createElement(be,{value:"0"},"\u4e00\u7ea7\u5206\u7c7b"),n.map((function(e){return r.a.createElement(be,{value:e._id,key:e._id},e.name)}))))),r.a.createElement(ge,null,e("categoryName",{rules:[{required:!0,message:"\u5206\u7c7b\u540d\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component);ye.propsTypes={categorys:fe.a.array.isRequired,parentId:fe.a.string.isRequired,setForm:fe.a.func.isRequired};var ve=f.a.create()(ye),Ee=f.a.Item,Oe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).props.setForm(a.props.form),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(f.a,null,r.a.createElement(Ee,null,e("categoryName",{initialValue:this.props.categoryName,rules:[{required:!0,message:"\u5206\u7c7b\u540d\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(n.Component);Oe.propsTypes={categoryName:fe.a.string.isRequired,setForm:fe.a.func.isRequired};var ke=f.a.create()(Oe),je=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={loading:!1,category:"",categorys:[],secCategory:[],parentId:"0",parentName:"",visible:0},a.initColumns=function(){a.columns=[{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name"},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(te,{onClick:function(){return a.showUpdate(e)}},"\u4fee\u6539\u5206\u7c7b"),"0"===e.parentId&&r.a.createElement(te,{onClick:function(){return a.getSecCategorys(e)}},"\u67e5\u770b\u5b50\u5206\u7c7b"))},width:300}]},a.getCategorts=function(){var e=Object(E.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t=t||a.state.parentId,e.next=4,P(t);case 4:n=e.sent,a.setState({loading:!1}),0===n.status?"0"===t?a.setState({categorys:n.data}):a.setState({secCategory:n.data}):j.a.error("\u5206\u7c7b\u6570\u636e\u83b7\u53d6\u5931\u8d25");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getSecCategorys=function(e){a.setState({parentId:e._id,parentName:e.name},(function(){a.getCategorts(a.state.parentId)}))},a.getFirCategory=function(){a.setState({secCategory:[],parentId:"0",parentName:""})},a.showAdd=function(){a.setState({visible:1})},a.addCategory=function(){a.form.validateFields(function(){var e=Object(E.a)(v.a.mark((function e(t,n){var r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return a.setState({visible:0}),r=n.categoryName,c=n.parentId,a.form.resetFields(),e.next=7,F(r,c);case 7:0===e.sent.status&&(c===a.state.parentId?a.getCategorts(a.state.parentId):"0"===c&&a.getCategorts("0"));case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.showUpdate=function(e){a.setState({visible:2,category:e})},a.updateCategory=function(){a.form.validateFields(function(){var e=Object(E.a)(v.a.mark((function e(t,n){var r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return a.setState({visible:0}),r=a.state.category._id,c=a.form.getFieldValue("categoryName"),a.form.resetFields(),e.next=8,S("/api/manage/category/update",{categoryName:(n={categoryName:c,categoryId:r}).categoryName,categoryId:n.categoryId},"POST");case 8:0===e.sent.status&&a.getCategorts(a.state.parentId);case 10:case"end":return e.stop()}var n}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.handleCancel=function(){a.form.resetFields(),a.setState({visible:0})},a.initColumns(),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getCategorts(this.state.parentId)}},{key:"render",value:function(){var e=this,t=this.state,a=t.categorys,n=t.loading,c=t.parentId,s=t.secCategory,o=t.parentName,i=t.category;return r.a.createElement("div",null,r.a.createElement(pe.a,{title:"0"===c?"\u4e00\u7ea7\u5546\u54c1\u5206\u7c7b":r.a.createElement("span",null,r.a.createElement(te,{onClick:this.getFirCategory},"\u4e00\u7ea7\u5546\u54c1\u5206\u7c7b"),r.a.createElement(b.a,{type:"arrow-right",style:{marginRight:5}}),r.a.createElement("span",null,o)),extra:r.a.createElement(h.a,{type:"primary",onClick:this.showAdd},r.a.createElement(b.a,{type:"plus"}),r.a.createElement("span",null,"\u6dfb\u52a0"))},r.a.createElement(me.a,{dataSource:"0"===c?a:s,columns:this.columns,rowKey:"_id",bordered:!0,pagination:{defaultPageSize:5,showQuickJumper:!0},loading:n}),r.a.createElement(Z.a,{title:"\u6dfb\u52a0\u5206\u7c7b",visible:1===this.state.visible,onOk:this.addCategory,onCancel:this.handleCancel},r.a.createElement(ve,{categorys:a,parentId:c,setForm:function(t){return e.form=t}})),r.a.createElement(Z.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===this.state.visible,onOk:this.updateCategory,onCancel:this.handleCancel},r.a.createElement(ke,{categoryName:i.name,setForm:function(t){return e.form=t}}))))}}]),t}(n.Component),we=de.a.Option,Ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={products:[],total:0,searchKey:"",searchType:"productName"},a.getProducts=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,r,c,s,o,i,l,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.props.updatePage(t),n=3,c=a.state,s=c.searchKey,o=c.searchType,!s){e.next=9;break}return e.next=6,R({pageNum:t,pageSize:n,searchKey:s,searchType:o});case 6:r=e.sent,e.next=12;break;case 9:return e.next=11,A(t,n);case 11:r=e.sent;case 12:0===r.status&&(i=r.data,l=i.list,u=i.total,a.setState({products:l,total:u}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.updateStatus=function(){var e=Object(E.a)(v.a.mark((function e(t,n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t,n);case 2:0===e.sent.status&&(j.a.success("\u66f4\u65b0\u6210\u529f"),a.getProducts(a.props.productPage||1));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.addProduct=function(){a.props.history.push("/product/addupdate")},a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\uffe5"+e}},{title:"\u72b6\u6001",width:80,render:function(e){var t=e._id,n=e.status,c=1===n?"\u4e0b\u67b6":"\u4e0a\u67b6",s=1===n?"\u5728\u552e":"\u5df2\u552e\u7a7a";return n=1===n?2:1,r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",onClick:function(){return a.updateStatus(t,n)}},c),r.a.createElement("span",null,s))}},{title:"\u64cd\u4f5c",width:80,render:function(e){return r.a.createElement("span",null,r.a.createElement(te,{onClick:function(){return a.props.history.push("/product/detail",e)}},"\u8be6\u60c5"),r.a.createElement(te,{onClick:function(){return a.props.history.push("/product/addupdate",e)}},"\u4fee\u6539"))}}],a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getProducts(this.props.productPage||1)}},{key:"render",value:function(){var e=this,t=this.state,a=t.products,n=t.total,c=t.searchKey,s=r.a.createElement("span",null,r.a.createElement(de.a,{defaultValue:"productName",style:{width:120},onChange:function(t){return e.setState({searchType:t})}},r.a.createElement(we,{value:"productName"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(we,{value:"productDesc"},"\u6309\u63cf\u8ff0\u641c\u7d22")),r.a.createElement(g.a,{placeholder:"\u5173\u952e\u5b57",style:{width:120,margin:"0 10px"},value:c,onChange:function(t){return e.setState({searchKey:t.target.value})}}),r.a.createElement(h.a,{type:"primary",onClick:function(){return e.getProducts(1)}},"\u641c\u7d22")),o=r.a.createElement(h.a,{type:"primary",onClick:this.addProduct},r.a.createElement(b.a,{type:"plus"}),"\u6dfb\u52a0\u5546\u54c1");return r.a.createElement(pe.a,{title:s,extra:o},r.a.createElement(me.a,{dataSource:a,columns:this.columns,bordered:!0,rowKey:"_id",pagination:{current:this.props.productPage,defaultPageSize:3,total:n,showQuickJumper:!0,onChange:function(t){return e.getProducts(t)}}}))}}]),t}(n.Component),xe=Object(s.b)((function(e){return{productPage:e.productPage}}),{updatePage:function(e){return{type:"update_page",pageNum:e}}})(Ce),Se=(a(774),a(534)),Ne=a(171),Ie=(a(1216),a(533));function _e(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var Te=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(E.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,_e(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,r,c,s,o,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,console.log("handleChange",r,n),"done"!==n.status){e.next=7;break}0===(c=n.response).status?(j.a.success("\u4e0a\u4f20\u6210\u529f\u4e86"),n=r[r.length-1],s=c.data,o=s.name,i=s.url,n.name=o,n.url=i):j.a.error("\u4e0a\u4f20\u5931\u8d25\u4e86"),e.next=12;break;case 7:if("removed"!==n.status){e.next=12;break}return e.next=10,K(n.name);case 10:0===e.sent.status?j.a.success("\u5220\u9664\u56fe\u7247\u6210\u529f"):j.a.error("\u5220\u9664\u56fe\u7247\u5931\u8d25");case 12:a.setState({fileList:r});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getPictures=function(){return a.state.fileList.map((function(e){return e.name}))};var n=(a.props.imgs||[]).map((function(e,t){return{uid:-t,name:e,status:"done",url:"http://localhost:5000/upload/"+e}}));return a.state={previewVisible:!1,previewImage:"",fileList:n},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,c=r.a.createElement("div",null,r.a.createElement(b.a,{type:"plus"}),r.a.createElement("div",null,"Upload"));return r.a.createElement("div",null,r.a.createElement(Ie.a,{accept:"image/*",action:"/api/manage/img/upload",name:"image",listType:"picture-card",fileList:n,onPreview:this.handlePreview,onChange:this.handleChange},n.length>=4?null:c),r.a.createElement(Z.a,{visible:t,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}]),t}(r.a.Component),Pe=a(143),Fe=a(526),Ae=a(527),Re=a.n(Ae),De=a(528),Ue=a.n(De),Ke=(a(904),function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).uploadImageCallBack=function(e){return new Promise((function(t,a){var n=new XMLHttpRequest;n.open("POST","/api/manage/img/upload");var r=new FormData;r.append("image",e),n.send(r),n.addEventListener("load",(function(){var e=JSON.parse(n.responseText);t({data:{link:e.data.url}}),console.log(e)})),n.addEventListener("error",(function(){var e=JSON.parse(n.responseText);a(e)}))}))},a.getEditor=function(){return Re()(Object(Pe.convertToRaw)(a.state.editorState.getCurrentContent()))},a.onEditorStateChange=function(e){a.setState({editorState:e})};var n=a.props.detail;if(n){var r=Ue()(n);if(r){var c=Pe.ContentState.createFromBlockArray(r.contentBlocks),s=Pe.EditorState.createWithContent(c);a.state={editorState:s}}}else a.state={editorState:Pe.EditorState.createEmpty()};return a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state.editorState;return r.a.createElement("div",null,r.a.createElement(Fe.Editor,{editorState:e,wrapperClassName:"demo-wrapper",editorStyle:{border:"1px solid black",minHeight:200,padding:"0 10px"},onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!1},previewImage:!0}}}))}}]),t}(n.Component)),Me=f.a.Item,Le=g.a.TextArea,Ve=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={options:[]},a.handleSubmit=function(){a.props.form.validateFields(function(){var e=Object(E.a)(v.a.mark((function e(t,n){var r,c,s,o,i,l,u,p,m;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=11;break}return r=a.pw.current.getPictures(),c=a.editor.current.getEditor(),s=n.name,o=n.desc,i=n.price,1===(l=n.categoryIds).length?(u="0",p=l[0]):(u=l[0],p=l[1]),m={name:s,desc:o,price:i,pCategoryId:u,categoryId:p,imgs:r,detail:c},a.isUpdate&&(m._id=a.product._id),e.next=9,M(m);case 9:0===e.sent.status?(j.a.success((a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0")+"\u5546\u54c1\u6210\u529f"),a.props.history.goBack()):j.a.error((a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0")+"\u5546\u54c1\u5931\u8d25");case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.validatorPrice=function(e,t,a){1*t>0?a():a("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0")},a.getCategorys=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,r,c,s,o,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:if(0!==(n=e.sent).status){e.next=20;break}if("0"!==t){e.next=19;break}if(r=n.data,c=r.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),a.setState({options:c}),s=a.product.pCategoryId,!a.isUpdate||"0"===s){e.next=17;break}return e.next=12,a.getCategorys(s);case 12:o=e.sent,i=o.map((function(e){return{label:e.name,value:e._id,isLeaf:!0}})),c.find((function(e){return e.value===s})).children=i,a.setState({options:Object(Ne.a)(a.state.options)});case 17:e.next=20;break;case 19:return e.abrupt("return",n.data);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadData=function(){var e=Object(E.a)(v.a.mark((function e(t){var n,r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,a.getCategorys(n.value);case 4:r=e.sent,n.loading=!1,r&&r.length>0?(c=r.map((function(e){return{label:e.name,value:e._id,isLeaf:!0}})),n.children=c):n.isLeaf=!0,a.setState({options:Object(Ne.a)(a.state.options)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var n=a.props.location.state;return a.isUpdate=!!n,a.product=n||{},a.pw=r.a.createRef(),a.editor=r.a.createRef(),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"render",value:function(){var e=this.product,t=this.isUpdate,a=e.pCategoryId,n=e.categoryId,c=e.imgs,s=e.detail,o=[];"0"===a?o.push(n):(o.push(a),o.push(n));var i=r.a.createElement("span",null,r.a.createElement(b.a,{type:"arrow-left",style:{color:"#1DA57A",fontSize:20,marginRight:5},onClick:this.props.history.goBack}),t?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1");return r.a.createElement("div",null,r.a.createElement(pe.a,{title:i},r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:9}}},r.a.createElement(Me,{label:"\u5546\u54c1\u540d\u79f0"},this.props.form.getFieldDecorator("name",{initialValue:t?e.name:"",rules:[{required:!0,message:"\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}))),r.a.createElement(Me,{label:"\u5546\u54c1\u63cf\u8ff0"},this.props.form.getFieldDecorator("desc",{initialValue:t?e.desc:"",rules:[{required:!0,message:"\u63cf\u8ff0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(Le,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autoSize:{minRows:2,maxRows:6}}))),r.a.createElement(Me,{label:"\u5546\u54c1\u4ef7\u683c"},this.props.form.getFieldDecorator("price",{initialValue:t?e.price:"",rules:[{required:!0,message:"\u4ef7\u683c\u5fc5\u987b\u8f93\u5165"},{validator:this.validatorPrice}]})(r.a.createElement(g.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"}))),r.a.createElement(Me,{label:"\u5546\u54c1\u5206\u7c7b"},this.props.form.getFieldDecorator("categoryIds",{initialValue:o})(r.a.createElement(Se.a,{options:this.state.options,loadData:this.loadData}))),r.a.createElement(Me,{label:"\u5546\u54c1\u56fe\u7247"},r.a.createElement(Te,{ref:this.pw,imgs:c})),r.a.createElement(Me,{label:"\u5546\u54c1\u8be6\u60c5",wrapperCol:{sm:{span:20}}},r.a.createElement(Ke,{ref:this.editor,detail:s})),r.a.createElement(Me,null,r.a.createElement(h.a,{type:"primary",onClick:this.handleSubmit},"\u63d0\u4ea4")))))}}]),t}(n.Component),qe=f.a.create()(Ve),ze=(a(905),a(343)),He=ze.a.Item,Be=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={cName1:"",cName2:""},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(E.a)(v.a.mark((function e(){var t,a,n,r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.location.state,a=t.pCategoryId,n=t.categoryId,"0"!==a){e.next=8;break}return e.next=4,D(n);case 4:r=e.sent,this.setState({cName1:r.data.name}),e.next=12;break;case 8:return e.next=10,Promise.all([D(a),D(n)]);case 10:c=e.sent,this.setState({cName1:c[0].data.name,cName2:c[1].data.name});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.cName1,n=t.cName2,c=r.a.createElement("span",null,r.a.createElement(b.a,{type:"arrow-left",style:{fontSize:20,marginRight:10,color:"#1DA57A"},onClick:function(){return e.props.history.goBack()}}),"\u5546\u54c1\u8be6\u60c5"),s=this.props.location.state,o=s.name,i=s.desc,l=s.price,u=s.imgs,p=s.detail;return r.a.createElement(pe.a,{title:c},r.a.createElement(ze.a,{className:"product-detail"},r.a.createElement(He,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u540d\u79f0\uff1a"),o),r.a.createElement(He,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u63cf\u8ff0\uff1a"),i),r.a.createElement(He,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u4ef7\u683c\uff1a"),l),r.a.createElement(He,null,r.a.createElement("span",{className:"left"},"\u6240\u5c5e\u5206\u7c7b\uff1a"),r.a.createElement("span",null,a," ",n?"--\x3e"+n:""," ")),r.a.createElement(He,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u56fe\u7247\uff1a"),u.map((function(e){return r.a.createElement("img",{src:"http://localhost:5000/upload/"+e,alt:"img",key:e})}))),r.a.createElement(He,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u8be6\u60c5\uff1a"),r.a.createElement("span",{className:"right",dangerouslySetInnerHTML:{__html:p}}))))}}]),t}(n.Component),Je=(a(907),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/product",component:xe,exact:!0}),r.a.createElement(d.b,{path:"/product/addupdate",component:qe}),r.a.createElement(d.b,{path:"/product/detail",component:Be}),r.a.createElement(d.a,{to:"/product"})))}}]),t}(n.Component)),We=f.a.Item,Qe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).props.setForm(a.props.form),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(f.a,null,r.a.createElement(We,null,e("roleName",{rules:[{required:!0,message:"\u89d2\u8272\u540d\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))))}}]),t}(n.Component);Qe.propsTypes={setForm:fe.a.func.isRequired};var Ge=f.a.create()(Qe),$e=(a(908),a(342)),Xe=f.a.Item,Ye=$e.a.TreeNode,Ze=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getTreeNodes=function(e){return e.reduce((function(e,t){return e.push(r.a.createElement(Ye,{title:t.title,key:t.key},t.children?a.getTreeNodes(t.children):null)),e}),[])},a.treeNodes=a.getTreeNodes(se),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.role,a=e.checkedKeys,n=e.onCheck;console.log("render");return r.a.createElement("div",null,r.a.createElement(Xe,Object.assign({label:"\u89d2\u8272\u540d\u79f0"},{labelCol:{span:4},wrapperCol:{span:15}}),r.a.createElement(g.a,{value:t.name,disabled:!0})),r.a.createElement($e.a,{defaultExpandAll:!0,checkable:!0,checkedKeys:a,onCheck:n},r.a.createElement(Ye,{title:"\u89d2\u8272\u6388\u6743",key:"0-0"},this.treeNodes)))}}]),t}(n.PureComponent),et=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={roles:[],role:{},isShowAdd:!1,isShowAuth:!1,checkedKeys:[]},a.initColumns=[{title:"\u89d2\u8272\u540d",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return ee(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:ee},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}],a.getRoleList=Object(E.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/api/manage/role/list");case 2:0===(t=e.sent).status?a.setState({roles:t.data}):j.a.error("\u89d2\u8272\u5217\u8868\u83b7\u53d6\u5931\u8d25");case 4:case"end":return e.stop()}}),e)}))),a.onRow=function(e){return{onClick:function(t){a.setState({role:e,checkedKeys:e.menus})}}},a.addRole=function(){a.form.validateFields(function(){var e=Object(E.a)(v.a.mark((function e(t,n){var r,c,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return r=n.roleName,a.form.resetFields(),e.next=6,L(r);case 6:0===(c=e.sent).status?(a.setState({isShowAdd:!1}),j.a.success("\u6dfb\u52a0\u89d2\u8272\u6210\u529f"),s=c.data,a.setState((function(e){return{roles:[].concat(Object(Ne.a)(e.roles),[s])}}))):j.a.error("\u6dfb\u52a0\u89d2\u8272\u6210\u529f");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.setRole=Object(E.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=a.state.role).menus=a.state.checkedKeys,t.auth_time=Date.now(),t.auth_name=a.props.user.username,e.next=6,V(t);case 6:0===e.sent.status?(a.setState({isShowAuth:!1}),a.setState({roles:Object(Ne.a)(a.state.roles)}),t._id===a.props.user.role_id?(a.props.logout(),j.a.success("\u6743\u9650\u53d1\u751f\u6539\u53d8\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55")):j.a.success("\u6388\u6743\u7ba1\u7406\u6210\u529f")):j.a.error("\u6388\u6743\u7ba1\u7406\u5931\u8d25");case 8:case"end":return e.stop()}}),e)}))),a.onCheck=function(e,t){a.setState({checkedKeys:e})},a.columns=a.initColumns,a.menus=r.a.createRef(),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getRoleList()}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.role,c=t.isShowAdd,s=t.isShowAuth,o=t.checkedKeys,i=r.a.createElement("span",null,r.a.createElement(h.a,{type:"primary",onClick:function(){return e.setState({isShowAdd:!0})}},"\u521b\u5efa\u89d2\u8272"),"\xa0\xa0",r.a.createElement(h.a,{type:"primary",disabled:!n._id,onClick:function(){return e.setState({isShowAuth:!0,role:n})}},"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"));return r.a.createElement("div",null,r.a.createElement(pe.a,{title:i},r.a.createElement(me.a,{rowKey:"_id",dataSource:a,columns:this.columns,pagination:{defaultPageSize:3,showQuickJumper:!0},onRow:this.onRow,rowSelection:{type:"radio",selectedRowKeys:[n._id],onSelect:function(t){return e.setState({role:t})}}}),r.a.createElement(Z.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:c,onOk:this.addRole,onCancel:function(){e.setState({isShowAdd:!1})}},r.a.createElement(Ge,{setForm:function(t){return e.form=t}})),r.a.createElement(Z.a,{title:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650",visible:s,onOk:this.setRole,onCancel:function(){e.setState({isShowAuth:!1,checkedKeys:n.menus})}},r.a.createElement(Ze,{role:n,checkedKeys:o,onCheck:this.onCheck}))))}}]),t}(n.Component),tt=Object(s.b)((function(e){return{user:e.user}}),{logout:Q})(et),at=de.a.Option,nt=f.a.Item,rt=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).props.setForm(a.props.form),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.roles,a=this.props.user||{};return r.a.createElement(f.a,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}},r.a.createElement(nt,{label:"\u7528\u6237\u540d"},e("username",{initialValue:a.username,rules:[{required:!0,message:"\u7528\u6237\u540d\u5fc5\u987b\u8f93\u5165"},{min:3,message:"\u7528\u6237\u540d\u4e0d\u5c0f\u4e8e3\u4f4d"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u79f0"}))),a._id?null:r.a.createElement(nt,{label:"\u5bc6\u7801"},e("password",{initialValue:"",rules:[{required:!0,message:"\u5bc6\u7801\u5fc5\u987b\u8f93\u5165"},{min:5,message:"\u5bc6\u7801\u4e0d\u5c0f\u4e8e5\u4f4d"}]})(r.a.createElement(g.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))),r.a.createElement(nt,{label:"\u7535\u8bdd"},e("phone",{initialValue:a.phone,rules:[{pattern:/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7535\u8bdd\u53f7\u7801"}))),r.a.createElement(nt,{label:"\u90ae\u7bb1"},e("email",{initialValue:a.email,rules:[{pattern:/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1"}]})(r.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"}))),r.a.createElement(nt,{label:"\u89d2\u8272\u540d\u79f0"},e("role_id",{initialValue:a.role_id})(r.a.createElement(de.a,{placeholder:"\u8bf7\u9009\u62e9\u89d2\u8272"},t.map((function(e){return r.a.createElement(at,{value:e._id,key:e._id},e.name)}))))))}}]),t}(n.Component);rt.propsTypes={setForm:fe.a.func.isRequired,roles:fe.a.array.isRequired,user:fe.a.object};var ct=f.a.create()(rt),st=Z.a.confirm,ot=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={visible:!1,users:[],roles:[],user:{}},a.initColumns=function(){return[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u89d2\u8272",dataIndex:"role_id",render:function(e){return a.rolesName[e]}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:ee},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(te,{onClick:function(){a.setState({user:e,visible:!0})}},"\u4fee\u6539"),r.a.createElement(te,{onClick:function(){return a.deleteUser(e)}},"\u5220\u9664"))}}]},a.getUsers=Object(E.a)(v.a.mark((function e(){var t,n,r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/api/manage/user/list");case 2:0===(t=e.sent).status&&(n=t.data,r=n.users,c=n.roles,a.rolesName=a.getRolesName(c),a.setState({users:r,roles:c}));case 4:case"end":return e.stop()}}),e)}))),a.getRolesName=function(e){return e.reduce((function(e,t){return e[t._id]=t.name,e}),[])},a.showAdd=function(){a.setState({visible:!0,user:{}})},a.addOrUpdateUser=function(){a.form.validateFields(function(){var e=Object(E.a)(v.a.mark((function e(t,n){var r,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return r=a.state.user._id,n._id=r,e.next=6,S("/api/manage/user/"+((s=n)._id?"update":"add"),s,"POST");case 6:c=e.sent,a.form.resetFields(),0===c.status?(a.getUsers(),a.setState({visible:!1}),j.a.success((r?"\u4fee\u6539":"\u6dfb\u52a0")+"\u7528\u6237\u6210\u529f")):j.a.error((r?"\u4fee\u6539":"\u6dfb\u52a0")+"\u7528\u6237\u5931\u8d25");case 9:case"end":return e.stop()}var s}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.deleteUser=function(e){console.log(e),st({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664<".concat(e.username,">\u5417\uff1f"),okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(E.a)(v.a.mark((function t(){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S("/api/manage/user/delete",{userId:e._id},"POST");case 2:n=t.sent,console.log(n),0===n.status?(a.getUsers(),j.a.success("\u5220\u9664\u7528\u6237\u6210\u529f")):j.a.error("\u5220\u9664\u7528\u6237\u5931\u8d25");case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})},a.columns=a.initColumns(),a.getUsers(),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.users,c=t.visible,s=t.user;return r.a.createElement(pe.a,{title:r.a.createElement(h.a,{type:"primary",onClick:this.showAdd},"\u521b\u5efa\u7528\u6237")},r.a.createElement(me.a,{dataSource:n,columns:this.columns,rowKey:"_id",bordered:!0,pagination:{defaultPageSize:3,showQuickJumper:!0}}),r.a.createElement(Z.a,{title:(s._id?"\u4fee\u6539":"\u6dfb\u52a0")+"\u7528\u6237",visible:c,onOk:this.addOrUpdateUser,onCancel:function(){e.form.resetFields(),e.setState({visible:!1})}},r.a.createElement(ct,{setForm:function(t){return e.form=t},roles:a,user:s})))}}]),t}(n.Component),it=a(169),lt=a.n(it),ut=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sales:[5,20,36,10,10,20],stores:[7,50,53,20,9,20]},a.update=function(){a.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.map((function(e){return e-1}))}}))},a.setOption=function(){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:a.state.sales},{name:"\u5e93\u5b58",type:"bar",data:a.state.stores}]}},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(pe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(h.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(pe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(lt.a,{option:this.setOption()})))}}]),t}(n.Component),pt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sales:[5,20,36,10,10,20],stores:[7,50,53,20,9,20]},a.update=function(){a.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.map((function(e){return e-1}))}}))},a.setOption=function(){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:a.state.sales},{name:"\u5e93\u5b58",type:"line",data:a.state.stores}]}},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(pe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(h.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(pe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(lt.a,{option:this.setOption()})))}}]),t}(n.Component),mt=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).setOption=function(){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:274,name:"\u8054\u76df\u5e7f\u544a"},{value:235,name:"\u89c6\u9891\u5e7f\u544a"},{value:400,name:"\u641c\u7d22\u5f15\u64ce"}].sort((function(e,t){return e.value-t.value})),roseType:"radius",label:{color:"rgba(255, 255, 255, 0.3)"},labelLine:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20},itemStyle:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(pe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(h.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(pe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(lt.a,{option:this.setOption()})))}}]),t}(n.Component),dt=(a(376),a(120)),ht=(a(377),a(67)),ft=(a(1214),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).goHome=function(){a.props.setHeaderTitle("\u9996\u9875"),a.props.history.replace("/home")},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(dt.a,{className:"not-found"},r.a.createElement(ht.a,{span:12,className:"left"})," ",r.a.createElement(ht.a,{span:12,className:"right"},r.a.createElement("h1",null,"404"),r.a.createElement("h2",null,"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"),r.a.createElement("div",null,r.a.createElement(h.a,{type:"primary",onClick:this.goHome}," \u56de\u5230\u9996\u9875 "))))}}]),t}(n.Component)),gt=Object(s.b)(null,{setHeaderTitle:W})(ft),bt=Y.a.Footer,yt=Y.a.Sider,vt=Y.a.Content,Et=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.user._id?r.a.createElement(Y.a,{style:{minHeight:"100%"}},r.a.createElement(yt,null,r.a.createElement(le,null)),r.a.createElement(Y.a,null,r.a.createElement(re,null,"Header"),r.a.createElement(vt,{style:{backgroundColor:"white",margin:20}},r.a.createElement(d.d,null,r.a.createElement(d.a,{exact:!0,from:"/",to:"/home"}),r.a.createElement(d.b,{path:"/home",component:ue}),r.a.createElement(d.b,{path:"/category",component:je}),r.a.createElement(d.b,{path:"/product",component:Je}),r.a.createElement(d.b,{path:"/role",component:tt}),r.a.createElement(d.b,{path:"/user",component:ot}),r.a.createElement(d.b,{path:"/charts/bar",component:ut}),r.a.createElement(d.b,{path:"/charts/line",component:pt}),r.a.createElement(d.b,{path:"/charts/pie",component:mt}),r.a.createElement(d.b,{component:gt}))),r.a.createElement(bt,{style:{textAlign:"center",color:"grey"}},"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff0c\u53ef\u4ee5\u83b7\u5f97\u66f4\u52a0\u7684\u9875\u9762\u663e\u793a\u64cd\u4f5c\u6548\u679c"))):r.a.createElement(d.a,{to:"/login"})}}]),t}(n.Component),Ot=Object(s.b)((function(e){return{user:e.user}}),{})(Et),kt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/login",component:X}),r.a.createElement(d.b,{path:"/",component:Ot})))}}]),t}(n.Component),jt=a(117),wt=a(530),Ct=a(531),xt=a(532);var St=B();var Nt=Object(jt.combineReducers)({headerTitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u9996\u9875",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"set_header_title":return t.data;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"receive_user":return t.user;case"send_error_msg":var a=t.msg;return Object(xt.a)({},e,{msg:a});case"reset_user":return{};default:return e}},productPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"update_page":return t.pageNum;default:return e}}}),It=Object(jt.createStore)(Nt,Object(Ct.composeWithDevTools)(Object(jt.applyMiddleware)(wt.a)));Object(c.render)(r.a.createElement(s.a,{store:It},r.a.createElement(kt,null)),document.getElementById("root"))},240:function(e,t,a){e.exports=a.p+"static/media/logo.ba1f87ec.png"},536:function(e,t,a){e.exports=a(1215)},551:function(e,t,a){},701:function(e,t,a){},702:function(e,t,a){},708:function(e,t,a){},907:function(e,t,a){}},[[536,1,2]]]);
//# sourceMappingURL=main.55d1ee18.chunk.js.map